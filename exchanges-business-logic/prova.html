<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prices on exchanges</title>
</head>

<body onload="buildChart()">
    <h1 style="text-align: center;">Prices on various exchanges</h1>
    <canvas id="chartCanvas" style="width: 60vw; height: 80vh; margin: auto; margin-top: 5vh;"></canvas>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        
        var date = '2021-12-18T13:00:00.000Z';
        var coin = 'LTC';
        var operation = 'buy';

        function buildChart() {
            const ctx = document.getElementById('chartCanvas').getContext('2d');
            var getKraken = fetch('http://localhost:2902/chart/dataset/crypto/'+coin+'/since/'+date+'/operation/'+operation+'/exchange/Kraken')
                .then(response => response.json());
                
            var getCoinbase = fetch('http://localhost:2902/chart/dataset/crypto/'+coin+'/since/'+date+'/operation/'+operation+'/exchange/Coinbase')
                .then(response => response.json());

            var getBinance = fetch('http://localhost:2902/chart/dataset/crypto/'+coin+'/since/'+date+'/operation/'+operation+'/exchange/Binance')
                .then(response => response.json());

            var getFTX = fetch('http://localhost:2902/chart/dataset/crypto/'+coin+'/since/'+date+'/operation/'+operation+'/exchange/FTX')
                .then(response => response.json());

            var getCrypto = fetch('http://localhost:2902/chart/dataset/crypto/'+coin+'/since/'+date+'/operation/'+operation+'/exchange/Crypto.com')
                .then(response => response.json());
                
            Promise.all([getKraken, getCoinbase, getBinance, getFTX, getCrypto])
            .then(([kraken, coinbase, binance, ftx, cryptoCom]) => {
                const configuration = {
                    type: 'line',
                    data: {
                        labels: kraken.dates,
                        datasets: []
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: false
                            }
                        }
                    }
                }
                configuration.data.datasets.push(kraken.dataset, coinbase.dataset, binance.dataset, ftx.dataset, cryptoCom.dataset);
                const chart = new Chart(ctx, configuration);
            });
        }

    </script>
</body>

</html>